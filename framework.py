from tools.nmap import nmap
from tools.dirb import dirb
from tools.nikto import nikto
from tools.sqlmap import sqlmap
from tools.ssh_bruteforce import ssh_bruteforce
from tools.ssh_login import ssh_login
from tools.wpscan import wpscan
from report import Report

class Framework:
    def __init__(self, ip):
        self.ip = ip
        self.dirb_wordlist = "/usr/share/wordlist/dirb/small.txt"
        self.tools_output = dict()
        self.ports_open = []
        self.directory_list = []
        self.ssh_creds = {
            "username": "",
            "password": "",
        }


        self.report = Report()
        self.nmap = nmap(self.ip)
        self.dirb = dirb(self.ip, self.dirb_wordlist)
        self.nikto = nikto(self.ip)
        self.sqlmap = sqlmap(self.ip, self.directory_list)
        self.ssh_bruteforce = ssh_bruteforce(self.ip)
        self.ssh_login = ssh_login(self.ip, self.ssh_creds["username"], self.ssh_creds["password"])
        self.wpscan = wpscan(self.ip)


    def run_nmap(self):
        nmap_output = self.nmap.run()
        self.tools_output["nmap"] = nmap_output
        self.ports_open = self.nmap.get_open_ports
        self.report.write_tool_output("nmap", nmap_output)
    
    def run_dirb(self):
        dirb_output = self.dirb.run()
        self.tools_output["dirb"] = dirb_output
    
    def run_nikto(self):
        nikto_output = self.nikto.run()
        self.tools_output["nikto"] = nikto_output
    
    def run_sqlmap(self):
        sqlmap_output = self.sqlmap.run()
        self.tools_output["sqlmap"] = sqlmap_output
    
    def run_ssh_bruteforce(self):
        ssh_bruteforce_output = self.ssh_bruteforce.run()
        self.tools_output["ssh_bruteforce"] = ssh_bruteforce_output

    def run_ssh_login(self):
        ssh_login_output = self.ssh_login.run()
        self.tools_output["ssh_login"] = ssh_login_output

    def run_wpscan(self):
        wpscan_output = self.wpscan.run()
        self.tools_output["wpscan"] = wpscan_output
    
    def finish(self):
        self.report.save()
    
# MAIN
framework = Framework("8.8.8.8")
framework.run_nmap()
# framework.run_dirb()
print(framework.tools_output)
# framework.report.generate_report(output)
framework.finish()