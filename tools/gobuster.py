import subprocess
import re

class gobuster:
    def __init__(self, ip, wordlist="/usr/share/wordlists/dirb/small.txt"):
        self.ip = ip
        self.wordlist = wordlist
        self.directories = []
    
    def run_command(self, cmd):
        try:
            # result = subprocess.run(cmd.split(), check=True, shell=True, capture_output=True, text=True)
            result = subprocess.run(cmd.split(), check=True, capture_output=True, text=True)
            return result
        except Exception as e:
            print(f"Failed to run command {cmd}.\nException: {e}")
    
    def run(self):
        cmd = f"gobuster dir -w {self.wordlist} -u http://{self.ip}/"
        result = self.run_command(cmd)
        output = result.stdout

        re_pattern_directory = f"http://{ip}*"
        directories = re.findall(re_pattern_directory, output)
        self.directories = re_pattern_directory
        print("Directories:", directories)
        return output