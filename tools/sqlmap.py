import subprocess

class sqlmap:
    def __init__(self, ip, directory_list=[]):
        self.ip = ip
        self.directory_list = directory_list

        self.questions = [
            "List the DBMS software information",
            "List all databases",
            "List all tables that are not present by default",
            "List the table schema and the  data present in each table",
            "List all users and their privileges",
            "What would you rate the sensitivity of the data present (0 being the lowest and 10 being the highest)"
        ]
    
    def run_command(self, cmd):
        try:
            # result = subprocess.run(cmd.split(), check=True, shell=True, capture_output=True, text=True)
            result = subprocess.run(cmd.split(), check=True, capture_output=True, text=True)
            return result
        except Exception as e:
            print(f"Failed to run command {cmd}.\nException: {e}")
    
    def run(self):
        for directory in self.directory_list:
            cmd = f"sqlmap -u http://{self.ip}/{directory}/"
            result = self.run_command(cmd)
            output = result.stdout
            # Extract info
            print(output)