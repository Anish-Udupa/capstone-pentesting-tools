import subprocess

class sqlmap:
    def __init__(self, ip, directory_list=[]):
        self.ip = ip
        self.directory_list = directory_list
    
    def run_command(self, cmd):
        try:
            # result = subprocess.run(cmd.split(), check=True, shell=True, capture_output=True, text=True)
            result = subprocess.run(cmd.split(), check=True, capture_output=True, text=True)
            return result
        except Exception as e:
            print(f"Failed to run command {cmd}.\nException: {e}")
    
    def run(self):
        for directory in self.directory_list:
            cmd = f"sqlmap -u http://{self.ip}/{directory}/"
            result = self.run_command(cmd)
            output = result.stdout
            # Extract info
            print(output)