from .util import run_command

class sqlmap:
    def __init__(self, ip, directory_list=[]):
        self.ip = ip
        self.directory_list = directory_list

        self.questions = [
            "List the DBMS software information",
            "List all databases",
            "List all tables that are not present by default",
            "List the table schema and the  data present in each table",
            "List all users and their privileges",
            "What would you rate the sensitivity of the data present (0 being the lowest and 10 being the highest)"
        ]
    
    # [{
    #     dbname: "",
    #     tables: [
    #         {
    #             table_name: "",
    #             row_list: [
    #                 ['col1_val', 'col2val'],
    #             ]
    #         },
    #     ]
    # }]
    
    def run(self):
        for directory_url in self.directory_list:
            # cmd = f"sqlmap -u http://{self.ip}/{directory}/"
            cmd = f"sqlmap --batch -v 0 -dbs -tables -u http://{directory_url}/"
            result = run_command(cmd)
            output = result['output']
            
            # Extract info
            print(output)