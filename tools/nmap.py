import subprocess
import re

class nmap:
    def __init__(self, ip):
        self.ip = ip
    
    def run_command(self, cmd):
        try:
            # result = subprocess.run(cmd.split(), check=True, shell=True, capture_output=True, text=True)
            result = subprocess.run(cmd.split(), check=True, capture_output=True, text=True)
            return result
        except Exception as e:
            print(f"Failed to run command {cmd}.\nException: {e}")

    def run(self):
        # cmd = f"nmap -sT --script vuln {self.ip}"
        cmd = f"nmap -sT {self.ip}"
        result = self.run_command(cmd)
        # Extract a list of ports and the vulnerability info
        output = result.stdout
        print(output)

        re_pattern_port = "([0-9]+)/tcp"
        ports = re.findall(re_pattern_port, output)
        self.ports = ports
        print(f"Ports: {ports}")