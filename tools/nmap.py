from .util import run_command
import re

class nmap:
    def __init__(self, ip):
        self.ip = ip
        self.open_ports = []

    def extract_features(self, data):
        pass

    def get_open_ports(self, output):
        re_pattern_port = "([0-9]+)/tcp"
        ports = re.findall(re_pattern_port, output)
        self.open_ports = [int(port) for port in ports]

    def run(self):
        cmd = f"nmap -sT {self.ip}"
        result = run_command(cmd)
        print(result)

        output = result["output"]
        print(output)

        
        # print(f"Ports: {ports}")
        # return output

        features = self.extract_features(output)
        return result
    
    def get_open_ports(self):
        return self.open_ports