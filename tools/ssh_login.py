import paramiko

class ssh_login:
    def __init__(self, ip, ssh_creds):
        self.ip = ip
        self.ssh_creds = ssh_creds

    def run(self):
        cmd = f"whoami"
        print("The command given:", cmd)
        result = {
            "status": None,
            "output": None,
            "error": None,
            "return_code": None,
        }

        try:
            username = self.ssh_creds["username"]
            password = self.ssh_creds["password"]

            ssh = paramiko.SSHClient()
            ssh.connect(self.ip, username=username, password=password)
            stdin, stdout, stderr = ssh.exec_command(cmd)
            if len(stderr) > 0:
                result['status'] = 'failure'
                result['error'] = stderr
            elif len(stdout) > 0:
                result['status'] = 'success'
                result['output'] = stdout
        except Exception as err:
            result['status'] = 'failure'
            result['error'] = err
        
        print(result)
        return result
