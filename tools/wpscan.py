from .util import run_command
from ../generative import GenAi
class wpscan:
    def __init__(self, ip):
        self.ip = ip
        self.misconfig=[]
        self.genai=GenAi()
        
    def extract_features(self,data):
        query="Return a list of major metasploitable misconfiguration present without the wpscan API token"
        return_format="[misconfiguration1,misconfiguration2,...]"
        soln=self.genai.get(query,return_format,data)
        if len(soln)>0:
            self.misconfig=soln
            return True
        else:
            return False
    def run(self):
        cmd = f"wpscan --url http://{self.ip}"
        result = run_command(cmd)
        print(result)
        # Scrape output for knownn vulnerabilities
        output = result['output']
        print(output)
